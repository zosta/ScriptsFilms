<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <link rel="stylesheet" type="text/css" href="Style/style.css">
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/dot-luv/jquery-ui.min.css">
    <style>
        .attribut {
            display: block;
        }

        #details-film {
            display: inline-block;
        }

        .colonne-attribut {
            display: inline-block;
        }

        #details-film {
            width: 600px;
        }

        #erreur-film {
            width: 600px;
        }

        .ui-dialog {
            width: auto;
        }

        #description {
            max-width: 800px;
            display: inline-block;
            margin-top: 20px;
        }

        .description {
            display: block;
        }

        .col1 {
            width: 185px;
            float: left;
            margin: auto;
        }

        .col2 {
            margin-left: 20px;
        }

        .col3 {
            margin-left: 20px;
            float: right;
            width: 185px;
        }

        .col1, .col2, .col3 {
            height: 300px;
            display: inline-block;
        }

        label {
            color: #0b3e6f;
            font-weight: bold;
            width: 200px;
            display: inline-block;
        }

        #definition-img {
            display: inline-block;
            width: 185px;
        }
    </style>

    <script type="text/javascript" src="Scripts/jquery-3.1.1_min.js"></script>
    <script type="text/javascript" src="Scripts/jquery_tablesorter_min.js"></script>

    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <!--<script>
        $(document).ready(function () {
            //$( "#details-film" ).dialog();
            //$( "#erreur-film" ).dialog();

            $("#myTable").tablesorter();
            $("#details-film").hide();
            $("#details-film2").hide();
            $("#erreur-film").hide();
        }
        );

        $(document).ready(function () {
            var url = 'http://api.themoviedb.org/3/',
                mode = 'search/movie?query=',
                input,
                movieName,
                key = '&api_key=62a498f13c891286abed1f67ad64fc9b',
                langue = '&&language=fr';

            $('.titre').click(function () {
                var input = $(this).text(),
                    movieName = encodeURI(input);

                var resolution = $(this).siblings(".resolution-film").text().split("x")[0];

                $.ajax({
                    type: 'GET',
                    url: url + mode + input + key + langue,
                    async: false,
                    jsonpCallback: 'testing',
                    contentType: 'application/json',
                    dataType: 'jsonp',
                    success: function (json) {

                        if (json.results.length < 1) {
                            $("#details-film").hide();
                            $("#erreur-film").text("Nous n'avons pas réussi à trouver le film, peut être internet n'est pas disponible ?")
                            $("#erreur-film").dialog({ width: "auto" });
                        }
                        else {

                            $("#erreur-film").hide();

                            var descr = json.results["0"].overview;
                            var note_moy = json.results["0"].vote_average;
                            var note_nb = json.results["0"].vote_count;
                            var titre_original = json.results["0"].original_title;
                            var titre = json.results["0"].title;
                            var cover = json.results["0"].poster_path;

                            var original_language = json.results["0"].original_language;
                            var genre_ids = json.results["0"].genre_ids;
                            var genres = "";
                            var nb = 0;
                            for (var k in genre_ids) {
                                nb++;
                                var genreid = genre_ids[k];
                                console.log(k, genre);
                                var genre = "";
                                switch (genreid) {
                                    case 28:
                                        genre = "Action";
                                        break;
                                    case 12:
                                        genre = "Aventure";
                                        break;
                                    case 16:
                                        genre = "Animation";
                                        break;
                                    case 35:
                                        genre = "Comédie";
                                        break;
                                    case 80:
                                        genre = "Crime";
                                        break;
                                    case 99:
                                        genre = "Documentaire";
                                        break;
                                    case 18:
                                        genre = "Drame";
                                        break;
                                    case 10751:
                                        genre = "Familial";
                                        break;
                                    case 14:
                                        genre = "Fantastique";
                                        break;
                                    case 36:
                                        genre = "Histoire";
                                        break;
                                    case 27:
                                        genre = "Horreur";
                                        break;
                                    case 10402:
                                        genre = "Musique";
                                        break;
                                    case 9648:
                                        genre = "Mystère";
                                        break;
                                    case 10749:
                                        genre = "Romance";
                                        break;
                                    case 878:
                                        genre = "Science-Fiction";
                                        break;
                                    case 10770:
                                        genre = "Téléfilm";
                                        break;
                                    case 53:
                                        genre = "Thriller";
                                        break;
                                    case 10752:
                                        genre = "Guerre";
                                        break;
                                    case 37:
                                        genre = "Western";
                                        break;
                                    default:
                                        genre = "";
                                }
                                if (nb == genre_ids.length){
                                    // c'est le dernier
                                    genres = genres + genre;
                                }else{
                                    genres = genres + genre + " , ";
                                }
                            }

                            var urlresolution = "";

                            if (resolution == "1920") {
                                urlresolution = "Style/1080P.png"
                            }
                            else if (resolution == "720") {
                                urlresolution = "Style/720P.png";
                            }
                            else {
                                urlresolution = "Style/sdtv.gif";
                            }

                            $("#titre_original").text(titre_original);
                            $("#titre").text(titre);
                            $("#description").text(descr);
                            $("#note_moy").text(note_moy);
                            $("#note_nb").text(note_nb);
                            $("#original_language").text(original_language);
                            $("#genre").text(genres);

                            $("#cover-img").attr('src', 'http://image.tmdb.org/t/p/w185/' + cover);

                            $("#definition-img").attr('src', urlresolution);

                            $("#details-film").dialog({ width: "auto" });

                            $("#details-film2").dialog({ width: "auto" });


                        }
                        console.dir(json);

                    },
                    error: function (e) {
                        console.log(e.message);

                    }
                });
            });
        });

    </script>-->

    <script>
            $(document).ready(function () {
                //$( "#details-film" ).dialog();
                //$( "#erreur-film" ).dialog();

                $("#myTable").tablesorter();
                $(".details-film2").hide();
                $("#erreur-film").hide();
                $('.titre').click(function () {
                    var input = $(this).text();

                    var movieName = input.replace(/\s/g, "_")
                    
                    var resolution = $(this).siblings(".resolution-film").text().split("x")[0];

                    $(".details-film2#" + movieName).dialog({ width: "auto" });


                });
            }
            );


    </script>


    <meta charset="utf-8" />
    <title>Export HTML de mes films</title>
</head>
<body>
    {STATISTIQUES}
    <table id="myTable" class="tablesorter">
        <thead>
            <tr>
                <th>Titre du film</th>
                <th>Année</th>
                <th>Durée</th>
                <th>Resolution</th>
                <th>Possède NFO</th>
            </tr>
        </thead>
        <tbody>
            {MES_FILMS}
        </tbody>
    </table>


    <div id="erreur-film" title="Erreur">

    </div>

    <!--<div class="details-film" title="Détails du film">
        <div id="couverture" class="colonne-attribut col1"><img id="cover-img" src="Style/ajax-loader.gif"></div>

        <div class="col2">
            <div class="attribut"><label>Titre : </label><div id="titre" class="colonne-attribut">Le titre</div></div>
            <div class="attribut"><label>Titre original : </label><div id="titre_original" class="colonne-attribut">Le titre original</div></div>
            <div class="attribut"><label>Année : </label><div id="annee" class="colonne-attribut">1995</div></div>
            <div class="attribut"><label>Durée : </label><div id="duree" class="colonne-attribut">1h35</div></div>
            <div class="attribut"><label>Note Moyenne : </label><div id="note_moy" class="colonne-attribut">6.4</div></div>
            <div class="attribut"><label>Nombre de votes : </label><div id="note_nb" class="colonne-attribut">6.4</div></div>
            <div class="attribut"><label>Format : </label><div id="extension" class="colonne-attribut">.mp4</div></div>
            <div class="attribut"><label>Résolution : </label><div id="resolution" class="colonne-attribut">1920x1080</div></div>
            <div class="attribut"><label>Langue d'origine : </label><div id="original_language" class="colonne-attribut">an</div></div>
            <div class="attribut"><label>Genre : </label><div id="genre" class="colonne-attribut">humour</div></div>
        </div>

        <div class="col3">
            <img src="" id="definition-img">
        </div>
        <div class="attribut"><label class="description">Résumé : </label> <div id="description" class="colonne-attribut description"> Nisi est notas iudicium sermo quod quasi oves amicitias quidem notas illis sermo ad magna eos amicos est eligendi est ad diligentiores est (saepe tollitque essent capras quasi quod quot essent amicitia) qui omnibus quot ad signa dicere amicis posse Ita ad oves rebus difficile parandis experiendum in praecurrit redeo expertum dicere constantes idonei ad enim et illis amicitia ad generis in difficile in erat nisi omnis amicis Scipionem habere stabiles sane erat tollitque firmi qui idonei posse ad dicere iudicium autem omnibus ad quod amicitia) iudicarent amicitia amicis experiendum et quot capras quisque qui quod quidem et est est.</div></div>

    </div>-->


    {INFOS_FILMS}




</body>
</html>